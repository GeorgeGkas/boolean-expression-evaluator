(this["webpackJsonpreact-typescript"]=this["webpackJsonpreact-typescript"]||[]).push([[0],{20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var r=n(11),a=n(1),o=n(7),i=n(4),c=n(2),s=n.n(c),u=n(0);function l(e){var t;return Object(u.jsxs)("form",{children:[Object.entries(e.args).map((t=e.onArgsChange,function(e,n){var r=Object(i.a)(e,2),a=r[0],o=r[1];return Object(u.jsxs)("section",{children:[Object(u.jsx)("input",{type:"name",value:a,onChange:function(e){e.target.value.trim()&&t({old:{name:a,value:o},new:{name:e.target.value.trim(),value:o}})}}),Object(u.jsxs)("select",{onChange:function(e){return t({old:{name:a,value:o},new:{name:a,value:"true"===e.target.value}})},defaultValue:String(o),children:[Object(u.jsx)("option",{value:"true",children:"true"}),Object(u.jsx)("option",{value:"false",children:"false"})]})]},n)})),Object(u.jsx)("button",{type:"button",onClick:function(){return e.onArgsChange({old:{},new:{name:"newArg".concat(Object.keys(e.args).length),value:!1}})},children:"+ add arg"})]})}var d=n(9);var N,O=n(3),v=n(8),p=n.n(v),j=n(12),h=n(13),b=n(23);!function(e){e.GENERIC="GENERIC",e.DISJUNCTION="Disjunction",e.CONJUNCTION="Conjunction",e.ARGUMENT="Argument",e.CONSTANT="Constant"}(N||(N={}));var f=function(){function e(){Object(j.a)(this,e),this.rootId=void 0,this.nodePool=new Map;var t=this.createGenericNode(null,0);this.rootId=t.id,this.nodePool.set(t.id,t)}return Object(h.a)(e,[{key:"getRootId",value:function(){return this.rootId}},{key:"getNodes",value:function(){return Array.from(this.nodePool.values())}},{key:"getNodeFromId",value:function(e){return this.nodePool.get(e)}},{key:"addChildNode",value:function(e,t,n){var r,o=this,i=this.nodePool.get(t),c=(r={},Object(a.a)(r,N.GENERIC,(function(){return o.createGenericNode(t,i.level+1)})),Object(a.a)(r,N.ARGUMENT,(function(){return o.createArgumentBinaryExpressionTreeNode(t,n,i.level+1)})),Object(a.a)(r,N.CONSTANT,(function(){return o.createConstantBinaryExpressionTreeNode(t,n,i.level+1)})),Object(a.a)(r,N.CONJUNCTION,(function(){return o.createConjunctionBinaryExpressionTreeNode(t,i.level+1)})),Object(a.a)(r,N.DISJUNCTION,(function(){return o.createDisjunctionBinaryExpressionTreeNode(t,i.level+1)})),r)[e]();return i.value.add(c.id),this.nodePool.set(c.id,c),c.id}},{key:"removeNodeById",value:function(e){var t=this.nodePool.get(e);if(t.type===N.GENERIC){if(t.id===this.rootId)return;var n=this.nodePool.get(t.parent);if((n.type===N.CONJUNCTION||n.type===N.DISJUNCTION)&&n.value.size<3)return;return n.value.delete(t.id),void this.nodePool.delete(t.id)}var r,a=Object(O.a)(this.traversalDFS(e));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.id!==e?this.nodePool.delete(o.id):this.changeNodeTypeById(e,N.GENERIC,"select...",!0)}}catch(i){a.e(i)}finally{a.f()}}},{key:"changeNodeTypeById",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.nodePool.get(e);if(!r&&(a.type===N.CONJUNCTION||a.type===N.DISJUNCTION)&&t!==N.CONJUNCTION&&t!==N.DISJUNCTION)throw new Error("is not possible to change complex operation to simple");if((t===N.CONJUNCTION||t===N.DISJUNCTION)&&a.type!==N.CONJUNCTION&&a.type!==N.DISJUNCTION){var o=this.createGenericNode(a.id,a.level+1),i=this.createGenericNode(a.id,a.level+1);return this.nodePool.set(o.id,o),this.nodePool.set(i.id,i),a.value=new Set([o.id,i.id]),void(a.type=t)}a.type=t,a.value=null!==n&&void 0!==n?n:a.value}},{key:"changeNodeValueById",value:function(e,t){this.nodePool.get(e).value=t}},{key:"createGenericNode",value:function(e,t){return{id:Object(b.a)(),type:N.GENERIC,value:"select...",parent:e,level:t}}},{key:"createArgumentBinaryExpressionTreeNode",value:function(e,t,n){return{id:Object(b.a)(),type:N.ARGUMENT,value:t,parent:e,level:n}}},{key:"createConstantBinaryExpressionTreeNode",value:function(e,t,n){return{id:Object(b.a)(),type:N.CONSTANT,value:t,parent:e,level:n}}},{key:"createDisjunctionBinaryExpressionTreeNode",value:function(e,t){var n=Object(b.a)(),r=this.createGenericNode(n,t+1),a=this.createGenericNode(n,t+1);return this.nodePool.set(r.id,r),this.nodePool.set(a.id,a),{id:n,type:N.DISJUNCTION,value:new Set([r.id,a.id]),parent:e,level:t}}},{key:"createConjunctionBinaryExpressionTreeNode",value:function(e,t){var n=Object(b.a)(),r=this.createGenericNode(n,t+1),a=this.createGenericNode(n,t+1);return this.nodePool.set(r.id,r),this.nodePool.set(a.id,a),{id:n,type:N.CONJUNCTION,value:new Set([r.id,a.id]),parent:e,level:t}}},{key:"traversalDFS",value:p.a.mark((function e(t){var n,r,a,o,i,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Set,(r=[]).push(t);case 3:if(!r.length){e.next=12;break}if(a=r.pop(),n.has(a)){e.next=10;break}if((o=this.nodePool.get(a)).type===N.CONJUNCTION||o.type===N.DISJUNCTION){i=Object(O.a)(o.value);try{for(i.s();!(c=i.n()).done;)s=c.value,r.push(s)}catch(u){i.e(u)}finally{i.f()}}return e.next=10,o;case 10:e.next=3;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"traversalPostOrder",value:p.a.mark((function e(t){var n,r,a,o,i,c,s,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null,(n=[]).push(t);case 3:if(!n.length){e.next=18;break}if(a=n[n.length-1],!((o=this.nodePool.get(a)).type!==N.CONJUNCTION&&o.type!==N.DISJUNCTION||!o.value.size||r&&o.value.has(r))){e.next=13;break}return e.next=9,o;case 9:n.pop(),r=o.id,e.next=16;break;case 13:i=Object(d.a)(o.value).reverse(),c=Object(O.a)(i);try{for(c.s();!(s=c.n()).done;)u=s.value,n.push(u)}catch(l){c.e(l)}finally{c.f()}case 16:e.next=3;break;case 18:case"end":return e.stop()}}),e,this)}))},{key:"dereferenceChildren",value:function(e){var t=this.nodePool.get(e);if(t.type===N.CONJUNCTION||t.type===N.DISJUNCTION){var n,r=[],a=Object(O.a)(t.value);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.push(this.dereferenceChildren(o))}}catch(i){a.e(i)}finally{a.f()}t.value=r}return t}},{key:"toJSON",value:function(){return this.dereferenceChildren(this.rootId)}}]),e}(),y=(n(20),function(e){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("option",{value:N.GENERIC,children:"select..."}),Object(u.jsx)("option",{value:N.CONSTANT,children:"constant"}),Object.keys(e.args).length&&Object(u.jsx)("option",{value:N.ARGUMENT,children:"argument"}),Object(u.jsx)("option",{value:N.CONJUNCTION,children:"and"}),Object(u.jsx)("option",{value:N.DISJUNCTION,children:"or"})]})}),C=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("option",{value:"".concat(N.CONSTANT,"-true"),children:"true"}),Object(u.jsx)("option",{value:"".concat(N.CONSTANT,"-false"),children:"false"})]})},T=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("option",{value:N.CONJUNCTION,children:"and"}),Object(u.jsx)("option",{value:N.DISJUNCTION,children:"or"})]})},I=T,x=function(e){return Object(u.jsx)(u.Fragment,{children:Object.entries(e.args).map((function(e,t){var n=Object(i.a)(e,1)[0];return Object(u.jsx)("option",{value:"".concat(N.ARGUMENT,"-").concat(n),children:n},t)}))})},g=function(e){var t;return(t={},Object(a.a)(t,N.GENERIC,Object(u.jsx)(y,{args:e.args})),Object(a.a)(t,N.CONSTANT,Object(u.jsx)(C,{})),Object(a.a)(t,N.ARGUMENT,Object(u.jsx)(x,{args:e.args})),Object(a.a)(t,N.CONJUNCTION,Object(u.jsx)(I,{})),Object(a.a)(t,N.DISJUNCTION,Object(u.jsx)(T,{})),t)[e.type]},E=function(e,t,n){return"object"===typeof t?e===N.CONJUNCTION?N.CONJUNCTION:N.DISJUNCTION:"string"===typeof t?"".concat(N.ARGUMENT,"-").concat(t):"".concat(N.CONSTANT,"-").concat(t)};function m(e){var t=function(t){return function(){e.binaryExpressionTree.removeNodeById(t),e.updateBinaryExpressionTreeNodes()}},n=function(t){return function(){e.binaryExpressionTree.addChildNode(N.GENERIC,t),e.updateBinaryExpressionTreeNodes()}};return s.a.useEffect((function(){var t,n=Object(O.a)(e.binaryExpressionTreeNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("Argument-Argument"===E(r.type,r.value,e.args))return e.binaryExpressionTree.changeNodeValueById(r.id,Object.keys(e.args).shift()),void e.updateBinaryExpressionTreeNodes()}}catch(a){n.e(a)}finally{n.f()}}),[e]),Object(u.jsx)("div",{className:"operation-builder-wrapper",children:e.binaryExpressionTreeNodes.map((function(r,a){var o,i,c=E(r.type,r.value,e.args);return Object(u.jsxs)("section",{className:"operation-node",style:{marginLeft:"".concat(30*r.level,"px")},children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("select",{value:c,onChange:(i=r.id,function(t){var n,r,a=t.target.value;a.startsWith(N.DISJUNCTION)?n=N.DISJUNCTION:a.startsWith(N.CONJUNCTION)?n=N.CONJUNCTION:a.startsWith(N.ARGUMENT)?(n=N.ARGUMENT,r=a.split("-").pop()):a.startsWith(N.CONSTANT)?(n=N.CONSTANT,r="true"===a.split("-").pop()):n=N.GENERIC,e.binaryExpressionTree.changeNodeTypeById(i,n,r),e.updateBinaryExpressionTreeNodes()}),children:Object(u.jsx)(g,{type:r.type,args:e.args})}),Object(u.jsx)("button",{className:"operation-node-remove-button",onClick:t(r.id),children:"\u2716"})]}),Object(u.jsx)("div",{children:Object(u.jsx)("button",{className:"operation-node-add-op-button ".concat((o=r.type,o!==N.CONJUNCTION&&o!==N.DISJUNCTION?"hidden":"")),onClick:n(r.id),children:"+ add op"})})]},a)}))})}var U=s.a.createContext(new f),S=function(e){return Object(u.jsx)(U.Provider,{value:new f,children:e.children})};function J(e){var t=String(function(e,t){var n,r=[],a=Object(O.a)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.type===N.GENERIC)return;if(o.type===N.ARGUMENT)r.push(t[o.value]);else if(o.type===N.CONSTANT)r.push(o.value);else if(o.type===N.CONJUNCTION){var i=r.reduce((function(e,t){return e&&t}),r.shift());(r=[]).push(i)}else{var c=r.reduce((function(e,t){return e||t}),r.shift());(r=[]).push(c)}}}catch(s){a.e(s)}finally{a.f()}return r.pop()}(e.binaryExpressionTreeNodesPostOrder,e.args));return Object(u.jsx)("p",{children:t})}function A(){var e=s.a.useState({}),t=Object(i.a)(e,2),n=t[0],r=t[1],c=s.a.useContext(U),N=s.a.useState(Array.from(c.traversalDFS(c.getRootId()))),O=Object(i.a)(N,2),v=O[0],p=O[1],j=s.a.useState(Array.from(c.traversalPostOrder(c.getRootId()))),h=Object(i.a)(j,2),b=h[0],f=h[1];return Object(u.jsx)(S,{children:Object(u.jsxs)("div",{children:[Object(u.jsx)(l,{args:n,onArgsChange:function(e){e.old.name?e.new.name!==e.old.name?r(function(e,t){var n=Object.keys(e).map((function(n){return Object(a.a)({},n in t?t[n]:n,e[n])}));return Object.assign.apply(Object,[{}].concat(Object(d.a)(n)))}(n,Object(a.a)({},e.old.name,e.new.name))):r(Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},e.old.name.trim(),e.new.value))):r(Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},e.new.name,e.new.value)))}}),Object(u.jsx)(m,{args:n,binaryExpressionTreeNodes:v,updateBinaryExpressionTreeNodes:function(){p(Array.from(c.traversalDFS(c.getRootId()))),f(Array.from(c.traversalPostOrder(c.getRootId())))},binaryExpressionTree:c}),Object(u.jsx)(J,{binaryExpressionTreeNodesPostOrder:b,args:n})]})})}var k=document.getElementById("root");Object(r.render)(Object(u.jsx)(A,{}),k)}},[[21,1,2]]]);
//# sourceMappingURL=main.e11ee385.chunk.js.map